{% extends "base.html" %}
{% block title %} Execute {% endblock %}

{% block body %}
<div class="row">
    <div class="card">
        <div class="card-header card-header-danger">
            <div class="container-fluid">
                <form action="" method="POST">
                    {{ form.csrf_token }}
                    <div class="row">
                        <div class="col-md-9">
                            <h4 class="card-title "> 신 재생 에너지 발전 정보 검색하기</h4>
                        </div>
                        {% for field in form.display %}
                        <div class="col-md-2">
                            {{ form[field](class="form-control") }}
                            {% if form[field].errors %}
                                {% for e in form[field.errors] %}
                                <p class="help-block">{{ e }}</p>
                                {% endfor %}
                            {% endif %}
                        </div>
                        {% endfor %}
                        <div class="col-md-1">
                            <button type="submit" class="btn btn-primary">요청하기</button>
                        </div>
                    </div>
                </form>
            </div>
        </div>

        <div class="card-body">
            <div class="row">
                <div class="col-md-6">
                    <div class="card card-stats">
                        <div class="card-header card-header-icon card-header-rose">
                            <div class="card-icon">
                                <i class="material-icons">content_copy</i>
                            </div>
                            <p class="card-category">최적의 태양광 에너지와 풍령 에너지 비율</p>
                            <h3 class="card-title">
                                {{ res['Optimal_prompt1'] }} : {{ res['Optimal_prompt2'] }}
                            </h3>
                        </div>
                        <div class="card-body"></div>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="card card-stats">
                        <div class="card-header card-header-icon card-header-rose">
                            <div class="card-icon">
                                <i class="material-icons">content_copy</i>
                            </div>
                            <p class="card-category">설비에 필요한 Cost</p>
                            <h3 class="card-title">
                                {{ res['Optimal_cost'] }}
                                <small>$</small>
                            </h3>
                        </div>
                        <div class="card-body"></div>
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-md">
                    <div class="card">
                        <div class="card-header card-header-primary">
                            <h4> 최적의 발전 량 </h4>
                        </div>
                        <div class="card-body">
                            <canvas id="myChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-md">
                    <div class="card">
                        <div class="card-header card-chart card-header-success">
                            <h4> 그 외 발전 량 정보 </h4>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-6">
                                    <canvas id="etcChart"></canvas>
                                </div>
                                <div class="col-md-6">
                                    <canvas id="etcChart2"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
var options = {
        responsive: true,
        tooltips: {
            mode: 'index',
            intersect: false,
        },
        hover: {
            mode: 'nearest',
            intersect: true
        },
        scales: {
            xAxes: [{
                display: true,
                scaleLabel: {
                    display: true,
                    labelString: 'x축'
                }
            }],
            yAxes: [{
                display: true,
                ticks: {
                    suggestedMin: 0,
                },
                scaleLabel: {
                    display: true,
                    labelString: 'y축'
                }
            }]
        }
    }
var labels = ['1','2','3','4','5','6','7','8','9','10',
            '11','12','13','14','15','16','17','18','19','20',
            '21','22','23','24']
new Chart(document.getElementById("etcChart"), {
    type: 'line',
    data: {
        labels: labels,
        datasets: [{
            label: 'P_pv',
            backgroundColor: "rgba(241, 86, 40, 1)",
            borderColor: "rgba(241, 86, 40, 1)",
            data: {{ res['P_pv']|safe }},
            fill: false,
        }, {
            label: 'P_wind',
            backgroundColor: "rgba(255, 200, 27, 1)",
            borderColor: "rgba(255, 200, 27, 1)",
            data: {{ res['P_wind']| safe }},
            fill: false,
        }, {
            label: 'P_load',
            backgroundColor: "rgba(28, 163, 146, 1)",
            borderColor: "rgba(28, 163, 146, 1)",
            data: {{ res['Optimal_p_load']| safe }},
            fill: false,
        }, ]
    },
    options: options
});

new Chart(document.getElementById("myChart"), {
    type: 'line',
    data: {
        labels: labels,
        datasets: [{
            label: 'Optimal_P_pv',
            backgroundColor: "rgba(241, 86, 40, 1)",
            borderColor: "rgba(241, 86, 40, 1)",
            data: {{ res['Optimal_p_pv']|safe }},
            fill: false,
        }, {
            label: 'Optimal_P_wind',
            backgroundColor: "rgba(255, 200, 27, 1)",
            borderColor: "rgba(255, 200, 27, 1)",
            data: {{ res['Optimal_p_wind']| safe }},
            fill: false,
        }, {
            label: 'Optimal_P_load',
            backgroundColor: "rgba(28, 163, 146, 1)",
            borderColor: "rgba(28, 163, 146, 1)",
            data: {{ res['Optimal_p_load']| safe }},
            fill: false,
        }
        ]
    },
    options: options
});

new Chart(document.getElementById("etcChart2"), {
    type: 'line',
    data: {
        labels: labels,
        datasets: [{
            label: 'Optimal_p_dummy',
            backgroundColor: "rgba(241, 86, 40, 1)",
            borderColor: "rgba(241, 86, 40, 1)",
            data: {{ res['Optimal_p_dummy']|safe }},
            fill: false,
        }, {
            label: 'Optimal_p_battery',
            backgroundColor: "rgba(255, 200, 27, 1)",
            borderColor: "rgba(255, 200, 27, 1)",
            data: {{ res['Optimal_p_battery']| safe }},
            fill: false,
        }, {
            label: 'Optimal_p_dg',
            backgroundColor: "rgba(28, 163, 146, 1)",
            borderColor: "rgba(28, 163, 146, 1)",
            data: {{ res['Optimal_p_dg']| safe }},
            fill: false,
        },]
    },
    options: options
});


</script>

{% endblock %}